#target "illustrator"#include "funcs.jsx"app.coordinateSystem = CoordinateSystem.ARTBOARDCOORDINATESYSTEM;var stateFunc=false;function moveAreaTextAuth(obj,box){    var objWideHalf = obj.width / 2;    var objHeightHalf = obj.height / 2;    var geoObj = obj.geometricBounds;    var rcWideHalf = (box[2] - box[0]) / 2;    var rcHeightHalf = (box[3] - box[1]) / 2;    var dx,dy;        dx = box[0] + (rcWideHalf - objWideHalf);    dy = box[1] + (rcHeightHalf - objHeightHalf);     obj.translate(dx ,-dy);}function makeAuthorText(author,box,isYoko){    var maxH = box[3] - box[1];    var maxW = box[2] - box[0];    maxH-=4;    var maxHtmp = (isYoko)?maxW:maxH;    var maxWtmp = (isYoko)?maxH:maxW;    var authQ = defAuthQ;    var space = mmToPt(tumeAuth);    var Qs;    var authStr="";    var realHeight=0;    if(author.length!=1){ //改行あり        var longerStr = (author[0].length > author[1].length)? author[0]:author[1];        authQ = decideMainQ(longerStr, maxH, authQ, isYoko);        authStr = author[0]+'\n'+author[1];        Qs = decideTotalQAuth(authQ,maxW,space,true);    }    else{        authStr=author[0];        authQ = decideMainQ(authStr, maxH, authQ, isYoko);        Qs = decideTotalQAuth(authQ,maxW,space,false);    }    var rc = (isYoko)?[0,0,maxWtmp,Qs[1]]:[0,0,Qs[1],maxHtmp];    var authObj = makeAreaText(authStr, Qs[0], rc, space, isYoko);    var tmpObj=authObj.duplicate();    var ot=tmpObj.createOutline();    realHeight=ot.height;    ot.remove();    authObj.textPath.height=realHeight;    if(checkOverflowTextArea(authObj))        expandAreaText(authObj);    return authObj;}try{    rurerOrigin();    var author;    var box;    if(DebugScript){        author = "原作:仲谷 鳰,漫画:結川 カズノ,缶乃,柊 ゆたか,文尾 文,ほか";        box = [335.455078125,510.59228515625,355.3388671875,744.07763671875];    }else{        author = arguments[0];        box = [arguments[1],arguments[2],arguments[3],arguments[4]];    }    if(author==""){    }else{        var isYoko=(author.match(/[a-z]/i))?true:false;        var authTxt = makeAuthorText(remakeAuthor(author),box,isYoko);        moveAreaTextAuth(authTxt,box);    }}catch(e){    stateFunc=true;}if(stateFunc) "NG";else "OK";